{% extends "base.html" %}

{% block title %}Devocionais Personalizados - Transforme seus momentos com Deus{% endblock %}

{% block content %}
{% if not user %}
<!-- LANDING PAGE DE CONVERS√ÉO -->
<div class="landing-page">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-badge">
                    <span class="badge-icon">‚ú®</span>
                    <span>Mais de 10.000 pessoas transformadas</span>
                </div>
                
                <h1 class="hero-title">
                    Transforme seus <span class="highlight">momentos dif√≠ceis</span> 
                    em <span class="highlight">encontros com Deus</span>
                </h1>
                
                <p class="hero-subtitle">
                    Receba devocionais personalizados baseados exatamente no que voc√™ est√° sentindo. 
                    Uma palavra de Deus espec√≠fica para o seu cora√ß√£o, no momento que voc√™ mais precisa.
                </p>
                
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-number">98%</div>
                        <div class="stat-label">Sentem paz ap√≥s usar</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">5min</div>
                        <div class="stat-label">Para gerar seu devocional</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">24/7</div>
                        <div class="stat-label">Dispon√≠vel sempre</div>
                    </div>
                </div>
                
                <div class="hero-cta">
                    <button onclick="startFreeExperience()" class="cta-button primary-cta">
                        <span class="cta-icon">üôè</span>
                        <span class="cta-text">Experimentar Gr√°tis Agora</span>
                        <span class="cta-subtitle">Seu primeiro devocional √© gratuito</span>
                    </button>
                    
                    <div class="trust-indicators">
                        <span class="trust-item">‚ö° Resultado em 30 segundos</span>
                        <span class="trust-item">üîí 100% Seguro e Privado</span>
                        <span class="trust-item">‚ù§Ô∏è Baseado na B√≠blia</span>
                    </div>
                </div>
            </div>
            
            <div class="hero-visual">
                <div class="preview-card">
                    <div class="preview-header">
                        <div class="preview-avatar">üôè</div>
                        <div class="preview-info">
                            <div class="preview-name">Devocional para Maria</div>
                            <div class="preview-feeling">Sentindo ansiedade</div>
                        </div>
                    </div>
                    <div class="preview-content">
                        <h3>"N√£o andeis ansiosos por coisa alguma..."</h3>
                        <p>Querida Maria, sei que seu cora√ß√£o est√° inquieto hoje. As preocupa√ß√µes parecem maiores que sua f√©, mas...</p>
                        <div class="preview-verse">üìñ Filipenses 4:6-7</div>
                    </div>
                </div>
                
                <div class="floating-elements">
                    <div class="floating-heart">üíñ</div>
                    <div class="floating-star">‚≠ê</div>
                    <div class="floating-dove">üïäÔ∏è</div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Problem Section -->
    <section class="problem-section">
        <div class="container">
            <h2 class="section-title">Voc√™ j√° se sentiu assim?</h2>
            
            <div class="problem-grid">
                <div class="problem-card">
                    <div class="problem-icon">üò∞</div>
                    <h3>Ansiedade tomando conta</h3>
                    <p>Preocupa√ß√µes que n√£o saem da mente, medos sobre o futuro, aquela sensa√ß√£o de que tudo pode dar errado...</p>
                </div>
                
                <div class="problem-card">
                    <div class="problem-icon">üò¢</div>
                    <h3>Tristeza profunda</h3>
                    <p>Momentos de melancolia, luto, decep√ß√µes que doem no peito e fazem questionar onde Deus est√°...</p>
                </div>
                
                <div class="problem-card">
                    <div class="problem-icon">üòî</div>
                    <h3>Solid√£o espiritual</h3>
                    <p>Sensa√ß√£o de dist√¢ncia de Deus, ora√ß√µes que parecem n√£o ser ouvidas, falta de dire√ß√£o na vida...</p>
                </div>
            </div>
            
            <div class="problem-statement">
                <p>Nesses momentos, voc√™ precisa de mais do que um devocional gen√©rico. Voc√™ precisa de uma palavra que fale diretamente ao seu cora√ß√£o.</p>
            </div>
        </div>
    </section>
    
    <!-- Solution Section -->
    <section class="solution-section">
        <div class="container">
            <div class="solution-content">
                <div class="solution-text">
                    <h2 class="section-title">Imagine receber uma carta de Deus escrita especialmente para voc√™</h2>
                    
                    <div class="solution-benefits">
                        <div class="benefit-item">
                            <div class="benefit-icon">üéØ</div>
                            <div class="benefit-text">
                                <h4>Personalizado para seu momento</h4>
                                <p>N√£o √© um devocional aleat√≥rio. √â uma mensagem criada com base no que voc√™ est√° vivendo agora.</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">üìö</div>
                            <div class="benefit-text">
                                <h4>Fundamentado na Palavra</h4>
                                <p>Cada devocional inclui vers√≠culos b√≠blicos relevantes e uma reflex√£o profunda e consoladora.</p>
                            </div>
                        </div>
                        
                        <div class="benefit-item">
                            <div class="benefit-icon">‚ö°</div>
                            <div class="benefit-text">
                                <h4>Dispon√≠vel a qualquer hora</h4>
                                <p>Seja 2h da manh√£ ou no meio do dia de trabalho - quando voc√™ precisar, estamos aqui.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="solution-visual">
                    <div class="solution-demo">
                        <div class="demo-step active" data-step="1">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Compartilhe seu sentimento</h4>
                                <div class="step-example">"Estou me sentindo perdido na vida..."</div>
                            </div>
                        </div>
                        
                        <div class="demo-step" data-step="2">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Aguarde 30 segundos</h4>
                                <div class="step-example">Nossa IA analisa e busca na B√≠blia</div>
                            </div>
                        </div>
                        
                        <div class="demo-step" data-step="3">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Receba sua mensagem</h4>
                                <div class="step-example">Um devocional √∫nico para voc√™</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Social Proof Section -->
    <section class="social-proof-section">
        <div class="container">
            <h2 class="section-title">Veja o que outras pessoas est√£o dizendo</h2>
            
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        <p>"Foi exatamente o que eu precisava ouvir. Como se Deus tivesse falado diretamente comigo atrav√©s deste devocional."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">üë©</div>
                        <div class="author-info">
                            <div class="author-name">Ana Paula</div>
                            <div class="author-location">S√£o Paulo, SP</div>
                        </div>
                    </div>
                </div>
                
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        <p>"Uso todos os dias. √â incr√≠vel como sempre recebo a palavra certa para o que estou passando. Mudou minha rotina de ora√ß√£o."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">üë®</div>
                        <div class="author-info">
                            <div class="author-name">Carlos Silva</div>
                            <div class="author-location">Rio de Janeiro, RJ</div>
                        </div>
                    </div>
                </div>
                
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        <p>"Estava passando por uma fase muito dif√≠cil. O devocional que recebi me trouxe uma paz que eu n√£o sentia h√° meses."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">üë©‚Äçü¶≥</div>
                        <div class="author-info">
                            <div class="author-name">Maria Santos</div>
                            <div class="author-location">Belo Horizonte, MG</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Urgency Section -->
    <section class="urgency-section">
        <div class="container">
            <div class="urgency-content">
                <h2>Seu cora√ß√£o est√° esperando uma palavra de Deus</h2>
                <p>Cada dia que passa sem essa conex√£o especial com Deus √© um dia a menos de paz, dire√ß√£o e prop√≥sito em sua vida.</p>
                
                <div class="urgency-stats">
                    <div class="urgency-stat">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-text">
                            <div class="stat-title">Apenas 2 minutos</div>
                            <div class="stat-desc">Para transformar seu dia</div>
                        </div>
                    </div>
                    
                    <div class="urgency-stat">
                        <div class="stat-icon">üéÅ</div>
                        <div class="stat-text">
                            <div class="stat-title">Primeiro devocional gr√°tis</div>
                            <div class="stat-desc">Sem compromisso</div>
                        </div>
                    </div>
                </div>
                
                <button onclick="startFreeExperience()" class="cta-button secondary-cta">
                    <span class="cta-text">Quero Meu Devocional Personalizado</span>
                    <span class="cta-arrow">‚Üí</span>
                </button>
            </div>
        </div>
    </section>
    
    <!-- FAQ Section -->
    <section class="faq-section">
        <div class="container">
            <h2 class="section-title">Perguntas Frequentes</h2>
            
            <div class="faq-grid">
                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFaq(this)">
                        <span>Como funciona o devocional personalizado?</span>
                        <span class="faq-icon">+</span>
                    </button>
                    <div class="faq-answer">
                        <p>Voc√™ compartilha como est√° se sentindo, nossa intelig√™ncia artificial analisa seu estado emocional e busca na B√≠blia vers√≠culos e palavras que falam diretamente ao seu cora√ß√£o. Em segundos, voc√™ recebe um devocional √∫nico e personalizado.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFaq(this)">
                        <span>√â realmente baseado na B√≠blia?</span>
                        <span class="faq-icon">+</span>
                    </button>
                    <div class="faq-answer">
                        <p>Absolutamente! Todos os devocionais s√£o fundamentados nas Sagradas Escrituras. Utilizamos vers√≠culos b√≠blicos relevantes e criamos reflex√µes que est√£o alinhadas com os ensinamentos crist√£os.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFaq(this)">
                        <span>Meus dados pessoais ficam seguros?</span>
                        <span class="faq-icon">+</span>
                    </button>
                    <div class="faq-answer">
                        <p>Sim! Seus sentimentos e informa√ß√µes s√£o tratados com total privacidade e seguran√ßa. N√£o compartilhamos seus dados com terceiros e voc√™ pode deletar suas informa√ß√µes a qualquer momento.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFaq(this)">
                        <span>Posso usar quantas vezes quiser?</span>
                        <span class="faq-icon">+</span>
                    </button>
                    <div class="faq-answer">
                        <p>O primeiro devocional √© completamente gratuito. Ap√≥s isso, oferecemos planos acess√≠veis para voc√™ continuar recebendo palavras personalizadas de Deus sempre que precisar.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Final CTA -->
    <section class="final-cta-section">
        <div class="container">
            <div class="final-cta-content">
                <h2>Deus tem uma palavra especial para voc√™ hoje</h2>
                <p>N√£o deixe esse momento passar. Clique abaixo e receba sua mensagem personalizada agora mesmo.</p>
                
                <button onclick="startFreeExperience()" class="cta-button final-cta">
                    <span class="cta-icon">‚ú®</span>
                    <span class="cta-text">Come√ßar Minha Jornada Espiritual</span>
                </button>
                
                <div class="final-guarantees">
                    <span>üîí Seguro e Privado</span>
                    <span>‚ö° Resultado em 30 segundos</span>
                    <span>üíù Primeiro devocional gr√°tis</span>
                </div>
            </div>
        </div>
    </section>
</div>

{% else %}
<!-- DASHBOARD DO USU√ÅRIO LOGADO -->
<div class="container">
    <div class="feeling-form-container">
        <div id="feeling-form-section" class="fade-in">
            <h1 class="main-title">‚ú® O que voc√™ est√° sentindo hoje? ‚ú®</h1>
            <p class="subtitle">Permita que Deus fale ao seu cora√ß√£o atrav√©s de uma palavra personalizada</p>
            
            <div class="mdc-card feeling-card interactive-element">
                <div class="card-content">
                    <div class="feeling-icons">
                        <div class="emoji-option" data-feeling="alegre">üòä</div>
                        <div class="emoji-option" data-feeling="triste">üò¢</div>
                        <div class="emoji-option" data-feeling="ansioso">üò∞</div>
                        <div class="emoji-option" data-feeling="grato">üôè</div>
                        <div class="emoji-option" data-feeling="esperan√ßoso">üåü</div>
                        <div class="emoji-option" data-feeling="preocupado">üòü</div>
                    </div>
                    
                    <form id="feeling-form" method="post">
                        <div class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea feeling-input">
                            <textarea class="mdc-text-field__input" id="sentimento" name="sentimento" rows="4" required 
                                placeholder="Descreva seus sentimentos... Ex: Estou me sentindo ansioso com o trabalho, mas confiante em Deus..."></textarea>
                            <div class="mdc-notched-outline">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label for="sentimento" class="mdc-floating-label">üí≠ Compartilhe o que est√° em seu cora√ß√£o...</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                        
                        <div class="button-container">
                            <button type="submit" id="generate-btn" class="mdc-button mdc-button--raised">
                                <span class="mdc-button__ripple"></span>
                                <span class="mdc-button__label">
                                    <span class="btn-text">üôè Gerar Devocional</span>
                                    <span class="loading" style="display: none;"></span>
                                </span>
                            </button>
                        </div>
                    </form>
                    
                    <div class="inspirational-quote">
                        <p>"Entrega o teu caminho ao Senhor; confia nele, e ele tudo far√°." - Salmos 37:5</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="devotional-result" class="mdc-card devotional-card" style="display: none;">
            <div class="card-content">
                <button id="back-button" class="devotional-back-button">
                    <span>‚Üê</span>
                </button>
                
                <div class="devotional-header">
                    <div class="devotional-icon">üôè</div>
                    <h2 id="sentiment-header">Sua Palavra de Hoje</h2>
                    <div class="devotional-date"></div>
                </div>
                
                <div class="devotional-body">
                    <div id="devotional-greeting" class="devotional-greeting slide-in-left"></div>
                    
                    <div class="devotional-verse-container">
                        <div class="verse-icon">üìñ</div>
                        <p id="devotional-verse-text" class="devotional-verse-text"></p>
                        <cite id="devotional-verse-reference" class="verse-reference"></cite>
                    </div>
                    
                    <div id="devotional-content" class="devotional-content slide-in-right"></div>
                    
                    <div class="devotional-actions">
                        <button id="share-btn" class="mdc-button mdc-button--outlined">
                            <span class="mdc-button__ripple"></span>
                            <span class="mdc-button__label">üì§ Compartilhar</span>
                        </button>
                        
                        <button id="save-btn" class="mdc-button mdc-button--outlined">
                            <span class="mdc-button__ripple"></span>
                            <span class="mdc-button__label">üíæ Salvar</span>
                        </button>
                        
                        <button id="new-devotional-btn" class="mdc-button mdc-button--raised">
                            <span class="mdc-button__ripple"></span>
                            <span class="mdc-button__label">‚ú® Novo Devocional</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
</div>

{% endblock %}

{% block scripts %}
<script>
    // ===================== LANDING PAGE SCRIPTS =====================
    
    // Fun√ß√£o para iniciar a experi√™ncia gratuita (CTA principal)
    function startFreeExperience() {
        // Adicionar um efeito visual de loading no bot√£o
        const button = event.target.closest('.cta-button');
        const originalContent = button.innerHTML;
        
        button.innerHTML = '<span class="loading-spinner">‚è≥</span> Redirecionando...';
        button.style.pointerEvents = 'none';
        
        // Simular um pequeno delay para dar feedback visual
        setTimeout(() => {
            window.location.href = '/login?redirect=/?try=true';
        }, 1000);
    }
    
    // FAQ Toggle
    function toggleFaq(button) {
        const item = button.closest('.faq-item');
        const answer = item.querySelector('.faq-answer');
        const icon = button.querySelector('.faq-icon');
        
        const isOpen = item.classList.contains('active');
        
        // Fechar todos os outros FAQs
        document.querySelectorAll('.faq-item').forEach(otherItem => {
            if (otherItem !== item) {
                otherItem.classList.remove('active');
                otherItem.querySelector('.faq-answer').style.maxHeight = '0';
                otherItem.querySelector('.faq-icon').textContent = '+';
            }
        });
        
        // Toggle do FAQ atual
        if (isOpen) {
            item.classList.remove('active');
            answer.style.maxHeight = '0';
            icon.textContent = '+';
        } else {
            item.classList.add('active');
            answer.style.maxHeight = answer.scrollHeight + 'px';
            icon.textContent = '‚àí';
        }
    }
    
    // Anima√ß√µes de scroll para a landing page
    function animateOnScroll() {
        const elements = document.querySelectorAll('.hero-content, .problem-card, .benefit-item, .testimonial-card');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        });
        
        elements.forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(30px)';
            el.style.transition = 'all 0.6s ease-out';
            observer.observe(el);
        });
    }
    
    // Demo steps animation
    function animateDemoSteps() {
        const steps = document.querySelectorAll('.demo-step');
        let currentStep = 0;
        
        function showNextStep() {
            steps.forEach(step => step.classList.remove('active'));
            steps[currentStep].classList.add('active');
            currentStep = (currentStep + 1) % steps.length;
        }
        
        if (steps.length > 0) {
            setInterval(showNextStep, 3000);
        }
    }
    
    // Floating elements animation
    function animateFloatingElements() {
        const floatingElements = document.querySelectorAll('.floating-heart, .floating-star, .floating-dove');
        
        floatingElements.forEach((element, index) => {
            const duration = 3000 + (index * 1000);
            const delay = index * 500;
            
            element.style.animationDuration = duration + 'ms';
            element.style.animationDelay = delay + 'ms';
        });
    }
    
    // ===================== DASHBOARD SCRIPTS (Para usu√°rios logados) =====================
    
    {% if user %}
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('feeling-form');
        const sentimentoInput = document.getElementById('sentimento');
        const feelingFormSection = document.getElementById('feeling-form-section');
        const devotionalResult = document.getElementById('devotional-result');
        const backButton = document.getElementById('back-button');
        const emojiOptions = document.querySelectorAll('.emoji-option');
        
        // Emoji selection
        emojiOptions.forEach(option => {
            option.addEventListener('click', function() {
                emojiOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                
                const feeling = this.dataset.feeling;
                const currentText = sentimentoInput.value;
                
                if (!currentText.includes(feeling)) {
                    sentimentoInput.value = `Estou me sentindo ${feeling}. ${currentText}`;
                }
                
                sentimentoInput.focus();
            });
        });
        
        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const sentimento = sentimentoInput.value.trim();
            if (!sentimento) {
                alert('Por favor, compartilhe como voc√™ est√° se sentindo.');
                return;
            }
            
            // Show loading state
            const submitBtn = document.getElementById('generate-btn');
            const btnText = submitBtn.querySelector('.btn-text');
            const loading = submitBtn.querySelector('.loading');
            
            btnText.style.display = 'none';
            loading.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            try {
                const response = await fetch('/api/devotional/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        sentimento: sentimento
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Erro ao gerar devocional');
                }
                
                const data = await response.json();
                
                // Show devotional result
                document.getElementById('devotional-greeting').textContent = data.greeting;
                document.getElementById('devotional-verse-text').textContent = data.verse.text;
                document.getElementById('devotional-verse-reference').textContent = data.verse.reference;
                document.getElementById('devotional-content').innerHTML = data.content;
                
                // Update header with sentiment
                document.getElementById('sentiment-header').textContent = `Palavra para quem est√° se sentindo ${sentimento.split('.')[0].toLowerCase()}`;
                
                // Update date
                document.querySelector('.devotional-date').textContent = new Date().toLocaleDateString('pt-BR', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                // Hide form and show result
                feelingFormSection.style.display = 'none';
                devotionalResult.style.display = 'block';
                devotionalResult.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('Erro:', error);
                alert('Ocorreu um erro ao gerar seu devocional. Tente novamente.');
            } finally {
                // Reset button state
                btnText.style.display = 'inline-block';
                loading.style.display = 'none';
                submitBtn.disabled = false;
            }
        });
        
        // Back button
        backButton.addEventListener('click', function() {
            devotionalResult.style.display = 'none';
            feelingFormSection.style.display = 'block';
            sentimentoInput.value = '';
            emojiOptions.forEach(opt => opt.classList.remove('selected'));
        });
        
        // New devotional button
        document.getElementById('new-devotional-btn').addEventListener('click', function() {
            backButton.click();
        });
        
        // Share functionality
        document.getElementById('share-btn').addEventListener('click', function() {
            const devotionalText = document.getElementById('devotional-content').textContent;
            const verseText = document.getElementById('devotional-verse-text').textContent;
            const verseRef = document.getElementById('devotional-verse-reference').textContent;
            
            const shareText = `${devotionalText}\n\n"${verseText}" - ${verseRef}\n\nGereado em: Devocionais Personalizados`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Meu Devocional Personalizado',
                    text: shareText
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Devocional copiado para a √°rea de transfer√™ncia!');
                });
            }
        });
        
        // Save functionality
        document.getElementById('save-btn').addEventListener('click', async function() {
            const devotionalData = {
                sentimento: sentimentoInput.value,
                greeting: document.getElementById('devotional-greeting').textContent,
                verse: {
                    text: document.getElementById('devotional-verse-text').textContent,
                    reference: document.getElementById('devotional-verse-reference').textContent
                },
                content: document.getElementById('devotional-content').textContent,
                date: new Date().toISOString()
            };
            
            try {
                const response = await fetch('/api/devotional/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(devotionalData)
                });
                
                if (response.ok) {
                    alert('Devocional salvo com sucesso!');
                    this.textContent = '‚úÖ Salvo';
                    this.disabled = true;
                } else {
                    throw new Error('Erro ao salvar');
                }
            } catch (error) {
                console.error('Erro ao salvar:', error);
                alert('Erro ao salvar o devocional. Tente novamente.');
            }
        });
        
        // Initialize MDC components for dashboard
        document.querySelectorAll('.mdc-text-field').forEach(function(el) {
            mdc.textField.MDCTextField.attachTo(el);
        });
    });
    {% else %}
    // Landing page initialization
    document.addEventListener('DOMContentLoaded', function() {
        animateOnScroll();
        animateDemoSteps();
        animateFloatingElements();
        
        // Add tracking for conversion optimization
        if (typeof gtag !== 'undefined') {
            gtag('event', 'page_view', {
                'page_title': 'Landing Page',
                'page_location': window.location.href
            });
        }
    });
    {% endif %}
</script>
{% endblock %}